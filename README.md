# 分布式光伏智能采集、异常分析与数据压缩装置
## 项目主要介绍：
### 项目简介：
设计了一套分布式光伏智能采集、异常分析与数据压缩装置。基于STM32的轻量级版本，实现电流电压波形高频采集、数据压缩和上传；基于i.MX6ULL的完整版本，实现高频采集、波形异常分析、数据压缩。
### 主要职责：
1.硬件电路的设计与调试，利用嘉立创EDA绘制STM32版本和i.MX6ULL版本的PCB，并打板测试。

2.采集部分，通过电流互感器和电压互感器将光伏逆变器交流侧的大电流和高电压信号转换为可测电压信号，采用可配置仪表放大器进行“换挡放大”。STM32上通过定时器+ADC+DMA实现采集；i.MX6ULL上利用ADS8688并使用C语言编写相关SPI设备驱动实现采集。

3.通信部分，采用MQTT协议将采集到的数据上报至云端服务器，同时利用DL/T698.45将数据发送给通信模块。

4.用C语言编写基于小波硬阈值+稀疏压缩算法，并移植到STM32和i.MX6ULL。用python编写轻量级CNN，并通过NCNN框架部署到i.MX6ULL。
### 项目成果：
项目成果：STM32版本波形数据误差小于0.5%，i.MX6ULL版本波形数据误差小于0.3%；数据压缩率大于50%。STM32版本现处于稳定性测试阶段；i.MX6ULL版本采集部分和通信部分已完成。

### 功能详细介绍
1.STM32版本（轻量级）
  STM32版本以STM32F103单片机为主控，利用定时器+ADC+DMA协同工作实现对光伏逆变器交流侧电压与电流波形的高频实时采集。随后，在单片机上实现基于小波硬阈值+稀疏压缩算法。最后，基于DL/T698.45协议将数据发送给通信模块，还通过MQTT（移远BC20）将数据上传云服务器，用于实验室使用（主要是支撑深度学习模型的训练）。整个项目具体可以细分为波形采集部分、压缩算法部分、通信部分。其中，核心在于对电流电压波形的高频采集（50KHZ）。本版本主要用于资源受限、安装困难的部署环境，仅负责波形数据的高精度采集。项目的核心在于对电流电压波形的高频采集。电流部分：光伏逆变器交流侧的大电流信号通过电流互感器（1000：1）转换为小电流，小电流经过高精度采样电阻转换为电压。为适配不同电流幅值场景，该电压信号被送入一组可配置的仪表放大器（INA128），利用MOS管的导通控制不同的电阻接入或断开，实现“换挡放大”，以在不同数量级的电流范围内保持高精度测量。电压部分：光伏逆变器交流侧的高电压通过电阻分压转换为小电流，随后通过电流型电压互感器（1：1）进行电气隔离，随后通过高精度采样电阻转换为电压，后续步骤同电流部分。最终，放大后的信号输入STM32，利用定时器+ADC+DMA实现高频率、连续且稳定的数据采集。波形数据误差小于0.5%。


2.Linux版本（完整）
  Linux版本以i.MX6ULL处理器为主控，运行嵌入式Linux操作系统，实现对光伏逆变器交流侧波形的采集、异常研判与数据压缩。波形采集部分在STM32的基础上加入了ADS8688用于提高采样精度（16位ADC、采样率最大500k）。异常研判部分利用i.MX6ULL部署轻量级神经网络（一维CNN），嵌入式神经网络模型对采集到的电流电压波形进行异常的智能识别与分类。数据压缩采用小波硬阈值压缩+稀疏压缩算法实现。最后通过DL/T698.45协议将压缩后数据发送给通信模块，还通过MQTT（高新兴ME3630-W）将压缩后数据上传云服务器。波形数据误差小于0.3%。压缩率大于50%。
